name: ci-db-encryption
on: [push, pull_request]
jobs:
  guard:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with: { node-version: '20' }
      - run: |
          key="${{ secrets.DB_ENCRYPTION_KEY }}"
          if [ "$key" = "" ]; then
            echo "DB_ENCRYPTION_KEY missing in secrets"; exit 1; fi
          if [ ${#key} -lt 32 ]; then
            echo "DB_ENCRYPTION_KEY too short"; exit 1; fi
